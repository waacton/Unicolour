<Router AppAssembly="@typeof(App).Assembly">
    <Found Context="routeData">
        <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)"/>
    </Found>
    <NotFound>
        @{
            NavigationManager.NavigateTo(NavMenu.LightRoute);
        }
    </NotFound>
</Router>

@code {
    [Inject] 
    public NavigationManager NavigationManager { get; set; } = null!;
    
    /*
     * extra guff for navigating to SPA routes while nested inside of 'github pages' deployment
     * e.g. site.com/colour-picker/      --> github serves /colour-picker/index.html
     *      site.com/colour-picker/paint --> github tries to serve /colour-picker/paint ... but doesn't exist so 404 ... need it to actually serve /colour-picker/index.html
     * 1. site.com/colour-picker/paint triggers github's 404.html
     * 2. 404.html has a script to redirect site.com/colour-picker/?page=paint
     * 3. site.com/colour-picker/ is served with query parameter ?page=paint
     * 4. blazor app is rendered, and if query parameter is detected it will navigate the SPA to that page
     */
    protected override void OnAfterRender(bool firstRender)
    {
        if (!firstRender || !NavigationManager.Uri.Contains("/?page=")) return;
        var page = NavigationManager.Uri.Split("/?page=")[1];
        NavigationManager.NavigateTo(page, forceLoad: false, replace: true);
    }
}